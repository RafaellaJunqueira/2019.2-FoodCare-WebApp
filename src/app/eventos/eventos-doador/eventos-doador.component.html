<mat-toolbar class="toolbar-eventos-doador">
    <img class="logo-img clickable" src="/logo-white.png" onclick="location.href='/'">
    <div *ngIf="doador">
        <button mat-button routerLink="/perfil-doador">
            <i class="material-icons">person_outline</i>
            {{ doador.username }}
        </button>
        <button mat-icon-button (click)="logout()" routerLink="/">
            <i class="material-icons logout">exit_to_app</i>
        </button>
    </div>
</mat-toolbar>

<!-- Criar evento-->
<ng-template #myDialog>
    <div>
        <div class="end-form">
            <form class="form" [formGroup]="registerForm" (ngSubmit)="onSubmit(registerForm.value)">
                <mat-form-field>
                    <input matInput formControlName="nome" placeholder="Nome" required>
                </mat-form-field>
                <div *ngIf="submitted && f.nome.errors" class="invalid-feedback">
                    <div *ngIf="f.nome.errors.required">Digite um nome para evento</div>
                </div>
                <div class="categoria">
                    <mat-form-field>
                        <mat-label>Categoria</mat-label>
                        <mat-select formControlName="categoria">
                            <mat-option *ngFor="let categoria of categorias" [value]="categoria.id">
                                {{ categoria.nome }}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                    <div *ngIf="submitted && f.categoria.errors" class="invalid-feedback">
                        <div *ngIf="f.categoria.errors.required">Digite um categoria para evento</div>
                    </div>
                </div>
                <div class="date">
                    <mat-form-field>
                        <input matInput type="datetime-local" placeholder="Data e hora de início"
                            formControlName="data_inicio" required />
                    </mat-form-field>
                </div>
                <div *ngIf="submitted && f.data_inicio.errors" class="invalid-feedback">
                    <div *ngIf="f.data_inicio.errors.required">Digite uma data de inicio para evento</div>
                </div>
                <div class="date">
                    <mat-form-field>
                        <input matInput type="datetime-local" placeholder="Data e hora de términio"
                            formControlName="data_final" required>
                    </mat-form-field>
                </div>
                <div *ngIf="submitted && f.data_final.errors" class="invalid-feedback">
                    <div *ngIf="f.data_final.errors.required">Digite uma data de fim para evento</div>
                </div>
                <div class="desc">
                    <mat-form-field>
                        <textarea formControlName="desc" matInput placeholder="Descrição" required></textarea>
                    </mat-form-field>
                    <div *ngIf="submitted && f.desc.errors" class="invalid-feedback">
                        <div *ngIf="f.desc.errors.required">Digite uma descrição para evento</div>
                    </div>
                </div>
                <div class="button-concluir">
                    <button mat-raised-button type="submit">Concluir</button>
                </div>
            </form>
        </div>
    </div>
</ng-template>

<!-- Card de eventos-->
<div class="div-conteiner">
    <mat-card *ngFor="let item of eventos">
        <div class="div-geral">
            <div class="div-img">
                <img mat-card-image class="img-categoria"
                    src="https://material.angular.io/assets/img/examples/shiba2.jpg" alt="Photo of a Shiba Inu">
            </div>
            <div class="div-infos">
                <div class="div-editar">
                    <h2>{{ item.nome }}</h2>
                    <button mat-icon-button class="edit" (click)="openDialog(editDialog); eventoSelecionado(item)">
                        <i class="material-icons">edit</i>
                    </button>
                </div>
                <div class="div-datas">
                    <p>{{ getFormatedDate(item.data_inicio) }}</p>
                    <p>{{ getFormatedDate(item.data_final) }}</p>
                </div>
            </div>
        </div>
        <mat-card-content>
            <h3>Descrição: <p>{{item.desc}}</p>
            </h3>
        </mat-card-content>

        <!-- Editar evento -->
        <ng-template #editDialog>
            <div class="end-form_edit">
                <div class="nome_edit">
                    <mat-form-field>
                        <input matInput placeholder="Nome" [(ngModel)]="selectedEvento.nome" required>
                    </mat-form-field>
                </div>
                <div class="categoria">
                    <mat-form-field>
                        <mat-label>Categoria</mat-label>
                        <mat-select [(ngModel)]="selectedEvento.id_categoria">
                            <mat-option *ngFor="let categoria of categorias" [value]="categoria.id">
                                {{ categoria.nome }}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
                <div class="date_edit">
                    <mat-form-field>
                        <input matInput type="datetime-local" placeholder="Data e hora de início"
                            [(ngModel)]="selectedEvento.data_inicio" required>
                    </mat-form-field>
                </div>
                <div class="date_edit">
                    <mat-form-field>
                        <input matInput type="datetime-local" placeholder="Data e hora de términio"
                            [(ngModel)]="selectedEvento.data_final" required>
                    </mat-form-field>
                </div>
                <div class="desc_edit">
                    <mat-form-field>
                        <textarea matInput placeholder="Descrição" [(ngModel)]="selectedEvento.desc"
                            required></textarea>
                    </mat-form-field>
                </div>
                <div class="button-concluir">
                    <button mat-raised-button (click)="updateEvento()">Concluir</button>
                </div>
                <div class="button-excluir">
                    <button mat-raised-button (click)="deleteEvento()">Excluir</button>
                </div>
            </div>

        </ng-template>
    </mat-card>
</div>

<!-- Botoes ao final na pagina-->
<button mat-icon-button class="button-add-evento" style="color: white" (click)="openDialog(myDialog); scrollToTop()">
    <i class="material-icons">add</i>
</button>